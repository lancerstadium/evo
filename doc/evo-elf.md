# ELF Binary Format

## ELF Header

| Attribute                                 | Size in Bytes | Description                                                                                                                                                                                                                                                                         |
|-------------------------------------------|:-------------:|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Identification                            |       16      | 0x7f 45 4c 46<br>file class (01 = 32bit or 02 = 64bit)<br>endianness (01 = little endian or 02 = big endian)<br>header version (usually 01)<br>OS ABI (usually 00 for System V)<br>ABI Version (00 for System V)<br>next 7 Bytes padding                                            |
| ELF Type                                  |       2       | 0 = none<br>1 = relocatable<br>2 = executable<br>3 = shared<br>4 = core<br>other reserved                                                                                                                                                                                           |
| ISA                                       |       2       | e.g. 0x3e for x86-64, 0xf3 for RISCV                                                                                                                                                                                                                                                |
| ELF Version                               |       4       | usually 1                                                                                                                                                                                                                                                                           |
| program entry address                     |       8       |                                                                                                                                                                                                                                                                                     |
| program header table offset               |       8       | in Bytes from beginning of file                                                                                                                                                                                                                                                     |
| section header table offset               |       8       | in Bytes from beginning of file                                                                                                                                                                                                                                                     |
| ISA dependent flags                       |       4       | For RISCV: <br>Bit 0: C ABI (Compact Instruction Format) targeted<br>Bit 1 and 2: targeted float ABIs (Bit 1: single; Bit 2: single and double; Bit 1 and 2: single, double and quad)<br>Bit 3: E ABI targeted<br>Bit 4: TSO Memory Consistency Model needed<br>other Bits reserved |
| ELF header size                           |       2       | in Bytes                                                                                                                                                                                                                                                                            |
| program header table entry size           |       2       | in Bytes                                                                                                                                                                                                                                                                            |
| number of entries in program header table |       2       |                                                                                                                                                                                                                                                                                     |
| section header table entry size           |       2       | in Bytes                                                                                                                                                                                                                                                                            |
| number of entries in section header table |       2       |                                                                                                                                                                                                                                                                                     |
| section name string table index           |       2       | index (in the section header table) of the special section containing the section name strings                                                                                                                                                                                      |

## ELF program header table (for 64 bit) (number of entries of the following form according to ELF header)

| Attribute              | Size in Bytes | Description                                                                                                                                   |
|------------------------|:-------------:|-----------------------------------------------------------------------------------------------------------------------------------------------|
| segment type           |       4       | 0 = unused<br>1 = loadable<br>2 = dynamic<br>3 = interpreter information<br>4 = notes<br>5 = reserved<br>6 = program header table information |
| flags                  |       4       | Bit 0: executable<br>Bit 1: writable<br>Bit 2: readable                                                                                       |
| offset                 |       8       | offset of the beginning of this segment from beginning of file in Bytes                                                                       |
| virtual memory adress  |       8       | virtual memory address of the start of this segment                                                                                           |
| physical memory adress |       8       | physical memory address of the start of this segment if needed (ignored otherwise)                                                            |
| size in file           |       8       | in Bytes                                                                                                                                      |
| size in memory         |       8       | in Bytes                                                                                                                                      |
| alignment              |       8       | always power of two                                                                                                                           |

## ELF section header table (for 64 bit) (number of entries of the following form according to ELF header)

| Attribute              | Size in Bytes | Description                                                                                                                                                                                                                                                                                       |
|------------------------|:-------------:|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| name index             |       4       | index of the name string in the section header string table                                                                                                                                                                                                                                       |
| type                   |       4       | 0 = inactive<br>1 = program bits (e.g. assembler instructions)<br>2 = symbol table<br>3 = string table<br>4 = relocation<br>5 = symbol hash table<br>6 = dynamic linking tables<br>7 = notes<br>8 = program bits without physical file space (e.g. uninitialized memory)<br>9 = relocation<br>... |
| flags                  |       8       | Bit 0: writable<br>Bit 1: allocated<br>Bit 2: machine instructions<br>...                                                                                                                                                                                                                         |
| virtual memory address |       8       | of the start of the section (0 if not allocated)                                                                                                                                                                                                                                                  |
| offset                 |       8       | of section start from beginning of file in Bytes                                                                                                                                                                                                                                                  |
| size                   |       8       | in file in Bytes                                                                                                                                                                                                                                                                                  |
| link index             |       4       | index of linked section (meaning dependent of type)                                                                                                                                                                                                                                               |
| info                   |       4       | extra info depending on type                                                                                                                                                                                                                                                                      |
| alignment              |       8       | always power of two                                                                                                                                                                                                                                                                               |
| entry size             |       8       | size of entries of section if known, 0 otherwise                                                                                                                                                                                                                                                  |


    
